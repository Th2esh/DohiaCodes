from function_frame import clone_order_action2
import schedule
import os
import requests
from sshtunnel import   SSHTunnelForwarder
import pymysql
import pandas as pd
# noinspection PyUnresolvedReferences








# clone_goods_sn || real_goods_sn || 2=shanghai 4=nantongZ

server = SSHTunnelForwarder(ssh_address_or_host=('39.100.94.96', 22), ssh_username='efast',
                                ssh_password='51ksCg7eZ!VUgNx',
                                remote_bind_address=('rm-vy1p7dyx917c11za2.mysql.rds.aliyuncs.com', 3306))
server.start()






db = pymysql.connect(host='127.0.0.1', port=server.local_bind_port, user='jusr2mmi49d8', passwd='uEZBjc9tQwoN',db='e3', charset='utf8')
cur = db.cursor()
cur.execute("update `schedule` set `value` = 100 where code = 'X_DDMS'")
db.commit()
print("订单免审计划任务已改为100分钟")
df = pd.read_excel("ceshi.xlsx", sheet_name="Sheet1")
clone_goods_sn = []
real_order_sn = []
a = df['克隆产品货号'].to_list()
for i in a:
    clone_goods_sn.append(str(i))
b = df['产品货号'].to_list()
for m in b:
    real_order_sn.append(str(m))


# clone_goods_sn = ['115020002400560','115020002420560','115020002430560','115020001040660','115011328960120','115011330230130','115011328460150','115011328970120','115011330240130','115011328470150','115011328980120','115011330250130','115011324070220','115011324070230','115011323690250','115011324080220','115011324080230','115011323700250','115011324090220','115011324090230','115011323710250','115011324130220','115011324130230','115011323740250','115011324140220','115011324140230','115011323750250','115011324150220','115011324150230','115011323760250','115011324160220','115011324160230','115011323770250','115011329000120','115011330270130','115011328500150','115011328990120','115011330260130','115011328490150','115011329020120','115011330300130','115011328520150','115011329010120','115011330290130','115011328510150','115020001060660','115020002440560','115020000510460','115020002450560','115020001050660','116021341320820','116021341350830','116021341170850','116020000080870','116021341310820','116021341340830','116021341160850','116020000070870','116011389510120','116011382600150','116010000970170','116011389520120','116011388590130','116011382610150','116010000980170','116011389530120','116011388600130','116011382620150','116010000990170','116011330500420','116011334140430','116011330510420','116011334150430','116011333280450','116011330520420','116011334160430','116011333290450','116011330530420','116011334170430','116011333300450','116011330540420','116011334180430','116011333310450','116011330550420','116011334190430','116011333320450','116011330590420','116011334240430','116011333330450','116011330600420','116011334250430','116011333340450  ','114021456160320','114021458860330','114021427150150','114021456170320','114021458870330','114021427160150','114021446550320','114021448270330','114021422990150','114021446560320','114021448280330','114021423000150','114021446530320','114021448250330','114021422970150','114021446540320','114021448260330','114021422980150','114021446570320','114021448290330','114021423010150','116011330220420','116011333450430','116011332580450','116011330230420','116011333460430','116011332590450','115020001400660']
#
#
#
# real_order_sn = ['115020002080560','115020001520560','115020001530560','115020000670660','115011326010120','115011326740130','115011325960150','115011326020120','115011326750130','115011325970150','115011326030120','115011326760130','115011323740220','115011323730230','115011323420250','115011323750220','115011323740230','115011323430250','115011323730220','115011323720230','115011323410250','115011327700120','115011328870130','115011327480150','115011327710120','115011328880130','115011327490150','115011327720120','115011328890130','115011327500150','115011327740120','115011328900130','115011327510150','115011327550120','115011328730130','115011327370150','115011327590120','115011328770130','115011327410150','115011327560120','115011328740130','115011327380150','115011327600120','115011328780130','115011327420150','115020000320460','115020000340460','115020000350460','115020000360460','115020001970560','116021340960820','116021340990830','116021340840850','116020000470860','116021340970820','116021341000830','116021340850850','116020000480860','116011386430120','116011381510150','116011381510150','116011386470120','116011385930130','116011381550150','116010000450170','116011386500120','116011385960130','116011381580150','116010000480170','116011327200420','116011328970430','116011327030420','116011328800430','116011327880450','116011327300420','116011329070430','116011328150450','116011327290420','116011329060430','116011328140450','116011327540420','116011329370430','116011328450450','116011328870420','116011331450430','116011330520450','116011329100420','116011331730430','116011330790450','116011329080420','116011331710430','116011330770450','114021443390320','114021445020330','114021421750150','114021443710320','114021445360330','114021421820150','114021438670320','114021440320330','114021419950150','114021438720320','114021440370330','114021420000150','114021438640320','114021440290330','114021419920150','114021438660320','114021440310330','114021419940150','114021438740320','114021440390330','114021420020150','116011327320420','116011329150430','116011328230450','116011327330420','116011329160430','116011328240450','115020000850660']




for i in range(len(clone_goods_sn)):
    print(i)
    clone_order_action2(clone_goods_sn[i],real_order_sn[i])



server = SSHTunnelForwarder(ssh_address_or_host=('39.100.94.96', 22), ssh_username='efast',
                                ssh_password='51ksCg7eZ!VUgNx',
                                remote_bind_address=('rm-vy1p7dyx917c11za2.mysql.rds.aliyuncs.com', 3306))
server.start()
db = pymysql.connect(host='127.0.0.1', port=server.local_bind_port, user='jusr2mmi49d8', passwd='uEZBjc9tQwoN',
                     db='e3', charset='utf8')
cur = db.cursor()
cur.execute("update `schedule` set `value` = 10 where code = 'X_DDMS'")
db.commit()
print("订单免审计划任务已改为10分钟")

# def send_wx(title,content):
#     sckey = "SCU38259Tdce55fedefed5a65374f74a41c6a7d375c233d11d819e"
#     url = 'https://sc.ftqq.com/' +sckey +'.send'
#     data = {'text':title,'desp':content}
#     result = requests.post(url,data)
#     return(result)
# title = '克隆订单计划任务'
# content ='计划任务已改为10分钟'
# send_wx(title,content)
# os._exit(0)

